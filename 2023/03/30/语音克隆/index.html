
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>语音克隆 | Isaky&#39;s blog</title>
        <meta name="author" content="Isaky" />
        <meta name="description" content="welcome to my world!!" />
        <meta name="keywords" content="" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
        <link rel="icon" href="/images/%E5%A4%B4%E5%83%8F.jpg" />
        <script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.2.1/css/all.min.css" />
<link rel="stylesheet" href="/css/fonts.min.css" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.org/highlight.js/11.7.0/highlight.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.org/highlight.js/11.7.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

        <canvas id="fireworks" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 32767"></canvas>
<script src="https://cdn.staticfile.org/animejs/3.2.1/anime.min.js"></script>
<script src="/js/fireworks.min.js"></script>
<canvas id="background" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: -1"></canvas>
<script src="/js/background.min.js"></script>
<div id="cursor"></div>
<link rel="stylesheet" href="/css/cursor.min.css">
<script src="/js/cursor.min.js"></script>


    <meta name="generator" content="Hexo 6.1.0"></head>
    <body>
        <div id="layout">
            <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存&ensp;浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
            </transition>
            <transition name="into">
            <div id="main" v-show="!loading">
                <nav id="menu" ref="menu">
    <div class="desktop-menu">
        <a class="title" href="/">
            <span>ISAKY&#39;S BLOG</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" v-show="showMenu" @click="showMenu = !showMenu"></div>
        <div class="title" @click="showMenu = !showMenu">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;ISAKY&#39;S BLOG</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="showMenu">
            
            <a href="/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>语音克隆</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/3/30
        </span>
        
        
    </div>
    
    <div class="content" v-pre>
        <h1>前言</h1>  
本次开发是针对互联网+项目虚拟人的语音克隆板块，内容参照开源项目<a target="_blank" rel="noopener" href="https://gitcode.net/mirrors/CorentinJ/Real-Time-Voice-Cloning">`Real-Time-Voice-Cloning`</a>  
论文地址：<a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1806.04558.pdf">《Transfer Learning from Speaker Verification to Multispeaker Text-To-Speech Synthesis》</a>  
<font color="red">发现可接受中文普通话输入，在此模型基础上进行改进的MockingBird </font>
<span id="more"></span>  
<h1>正文</h1>  
语音克隆总共通过三个模型组成：`encoder`、`Synthesizer`、`Vocoder`  
Encoder模型:对扬声器输入语音进行处理  
Synthesizer模型:根据说话人嵌入向量的条件从一连串字母或音符输入中预测出一个`mel spectrogram`  
Vocoder模型：将合成器合成的谱图转化为时域波形  
而相较于RTVC来说MB增加了`ppg2mel`模型即--`mel-spectrogram预测网络`  
训练数据集：无记录的嘈杂噪音数据集  
<h3>训练</h3>  
本次使用的是预训练编码器/声码器而不是合成器，因为原始模型与中文符号不兼容。这意味着 demo_cli 目前不工作，因此需要额外的合成器模型。而在原始项目中，存在与训练好的编码器、合成器、生码器。  
想自己在原作者的模型上进行训练，结果直接崩溃了，在`synthesizer/haprams.py`中改`batch_size`:  
>tts_schedule = [(2, 1e-3, 20_000, 8), # Progressive training schedule  
(2, 5e-4, 40_000, 8), # (r, lr, step, batch_size)  
(2, 2e-4, 80_000, 8), #  
(2, 1e-4, 160_000, 8), # r = reduction factor (# of mel frames  
(2, 3e-5, 320_000, 8), # synthesized for each decoder iteration)  
(2, 1e-5, 640_000, 8)], # lr = learning rate    
 
<hr>
<p><font color=red><h3>更新</h3><br>预期使用的mockingbird只能在ui界面，demo总有问题，换成了paddlespeech，发现运行挺快，微调数据量也小。<br>在小数据量微调模型过程中，使用6句共18秒的通过处理的目标人物音频，逐次递增100步观察模型合成音频效果，训练两百步时的模型合成声音已经与目标声音很接近了，loss值在0.438左右；500步时loss值达到0.340412，但是发现虽然loss值在不断减少，但是音频合成质量反而有所下降并且出现了电音。<br>我要串起来了！！<br></font>  </p>
<hr>
<h3>问题一</h3>  
<font color="orange">好家伙MK里面的路径要改，发现缺东西，结果意外发现缺的在RTVC那里有</font>  
在`demo_cli.py`修改预训练模型地址和音频地址，注意文件地址斜杠用**`/`**  
pip下载太慢了，之前是配置好镜像源的，弄torch报错就删了，让我们感谢`-i https://pypi.tuna.tsinghua.edu.cn/simple gevent`  
<h3>问题二</h3>  
在运行过程中，总是出现下面报错：  

<blockquote>
<p>Caught exception: ValueError(‘The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()’)  </p>
</blockquote>
<p>但是不知道问题在哪儿，使用<code>traceback</code>:  </p>
<blockquote>
<p>import traceback<br>try:<br>    # Your code that raises the exception<br>except Exception as e:<br>    traceback.print_exc()  </p>
</blockquote>
<hr>

    </div>
    
    
    
    
    
    
    
</div>

                <footer id="footer">
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
<span class="post-meta-divider">|</span>
<span id="busuanzi_container_site_uv">本站访客数<span id="busuanzi_value_site_uv"></span>人</span>
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2023 Isaky&#39;s blog
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Isaky
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

            </div>
            </transition>
            
            <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
            </transition>
            
        </div>
        <script src="/js/main.js"></script>
        
        




        
    </body>
</html>
